package integrity

import (
	"crypto/rand"
	"crypto/rsa"
	"crypto/sha256"
	"encoding/base64"
	"fmt"
	"os"
)

const (
	// rsa 4096 integrity key
	integrityPrivateKey = `-----BEGIN PRIVATE KEY-----
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
I+QAbR7cNjM5lJzksS6JwdfZ/U8H
-----END PRIVATE KEY-----
`
)

func EncryptOAEP(secretMessage string, pubkey rsa.PublicKey) string {
	label := []byte("OAEP Encrypted")
	// crypto/rand.Reader is a good source of entropy for randomizing the
	// encryption function.
	rng := rand.Reader
	ciphertext, err := rsa.EncryptOAEP(sha256.New(), rng, &pubkey, []byte(secretMessage),    label)
	if err != nil {
		fmt.Fprintf(os.Stderr, "Error from encryption: %s\n", err)
		return "Error from encryption";
	}
	return base64.StdEncoding.EncodeToString(ciphertext)
}